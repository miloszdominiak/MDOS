#include <terminal.h>
#include <ports.h>
#include <stdio.h>

#define COLOR(bg,fg) bg << 4 | fg;
#define VGA_ENTRY(c,color) color << 8 | (uint8_t)c

uint32_t screen_width, screen_height;

uint32_t terminal_color = COLOR(VGA_COLOR_BLACK, VGA_COLOR_LIGHT_GREY);
uint32_t terminal_row, terminal_column;
uint32_t terminal_rows, terminal_columns;

uint32_t* vesa_buffer;

uint8_t font[256][16] = 
{{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 24, 24, 24, 24, 24, 24, 24, 0, 24, 24, 0, 0, 0, 0},
{0, 102, 102, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 108, 108, 108, 254, 108, 108, 254, 108, 108, 108, 0, 0, 0, 0},
{0, 16, 16, 124, 214, 208, 208, 124, 22, 22, 214, 124, 16, 16, 0, 0},
{0, 0, 102, 214, 108, 12, 24, 24, 48, 54, 107, 102, 0, 0, 0, 0},
{0, 0, 56, 108, 108, 56, 118, 220, 204, 204, 220, 118, 0, 0, 0, 0},
{0, 24, 24, 24, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 12, 24, 48, 48, 48, 48, 48, 48, 24, 12, 0, 0, 0, 0},
{0, 0, 48, 24, 12, 12, 12, 12, 12, 12, 24, 48, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 108, 56, 254, 56, 108, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 24, 24, 126, 24, 24, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 24, 24, 48, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 254, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 24, 24, 0, 0, 0, 0},
{0, 0, 6, 6, 12, 12, 24, 24, 48, 48, 96, 96, 0, 0, 0, 0},
{0, 0, 124, 198, 198, 206, 222, 246, 230, 198, 198, 124, 0, 0, 0, 0},
{0, 0, 0, 24, 56, 120, 24, 24, 24, 24, 24, 126, 0, 0, 0, 0},
{0, 0, 124, 198, 198, 6, 12, 24, 48, 96, 192, 254, 0, 0, 0, 0},
{0, 0, 124, 198, 198, 6, 60, 6, 6, 198, 198, 124, 0, 0, 0, 0},
{0, 0, 6, 14, 30, 54, 102, 198, 254, 6, 6, 6, 0, 0, 0, 0},
{0, 0, 254, 192, 192, 192, 252, 6, 6, 6, 198, 124, 0, 0, 0, 0},
{0, 0, 60, 96, 192, 192, 252, 198, 198, 198, 198, 124, 0, 0, 0, 0},
{0, 0, 254, 6, 6, 12, 12, 24, 24, 48, 48, 48, 0, 0, 0, 0},
{0, 0, 124, 198, 198, 198, 124, 198, 198, 198, 198, 124, 0, 0, 0, 0},
{0, 0, 124, 198, 198, 198, 198, 126, 6, 6, 12, 120, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 24, 24, 0, 0, 0, 24, 24, 0, 0, 0, 0},
{0, 0, 0, 0, 24, 24, 0, 0, 0, 24, 24, 48, 0, 0, 0, 0},
{0, 0, 0, 6, 12, 24, 48, 96, 48, 24, 12, 6, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 254, 0, 0, 254, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 96, 48, 24, 12, 6, 12, 24, 48, 96, 0, 0, 0, 0},
{0, 0, 124, 198, 198, 198, 12, 12, 12, 0, 12, 12, 0, 0, 0, 0},
{0, 0, 124, 198, 206, 214, 214, 214, 214, 206, 192, 126, 0, 0, 0, 0},
{0, 0, 124, 198, 198, 198, 198, 254, 198, 198, 198, 198, 0, 0, 0, 0},
{0, 0, 252, 198, 198, 198, 252, 198, 198, 198, 198, 252, 0, 0, 0, 0},
{0, 0, 124, 198, 198, 192, 192, 192, 192, 198, 198, 124, 0, 0, 0, 0},
{0, 0, 248, 204, 198, 198, 198, 198, 198, 198, 204, 248, 0, 0, 0, 0},
{0, 0, 254, 192, 192, 192, 248, 192, 192, 192, 192, 254, 0, 0, 0, 0},
{0, 0, 254, 192, 192, 192, 248, 192, 192, 192, 192, 192, 0, 0, 0, 0},
{0, 0, 124, 198, 198, 192, 192, 222, 198, 198, 198, 124, 0, 0, 0, 0},
{0, 0, 198, 198, 198, 198, 254, 198, 198, 198, 198, 198, 0, 0, 0, 0},
{0, 0, 60, 24, 24, 24, 24, 24, 24, 24, 24, 60, 0, 0, 0, 0},
{0, 0, 30, 12, 12, 12, 12, 12, 12, 204, 204, 120, 0, 0, 0, 0},
{0, 0, 198, 198, 204, 216, 240, 240, 216, 204, 198, 198, 0, 0, 0, 0},
{0, 0, 192, 192, 192, 192, 192, 192, 192, 192, 192, 254, 0, 0, 0, 0},
{0, 0, 130, 198, 238, 254, 214, 198, 198, 198, 198, 198, 0, 0, 0, 0},
{0, 0, 198, 198, 198, 230, 246, 222, 206, 198, 198, 198, 0, 0, 0, 0},
{0, 0, 124, 198, 198, 198, 198, 198, 198, 198, 198, 124, 0, 0, 0, 0},
{0, 0, 252, 198, 198, 198, 198, 252, 192, 192, 192, 192, 0, 0, 0, 0},
{0, 0, 124, 198, 198, 198, 198, 198, 198, 198, 222, 124, 6, 0, 0, 0},
{0, 0, 252, 198, 198, 198, 198, 252, 240, 216, 204, 198, 0, 0, 0, 0},
{0, 0, 124, 198, 192, 192, 124, 6, 6, 198, 198, 124, 0, 0, 0, 0},
{0, 0, 255, 24, 24, 24, 24, 24, 24, 24, 24, 24, 0, 0, 0, 0},
{0, 0, 198, 198, 198, 198, 198, 198, 198, 198, 198, 124, 0, 0, 0, 0},
{0, 0, 198, 198, 198, 198, 198, 108, 108, 108, 56, 56, 0, 0, 0, 0},
{0, 0, 198, 198, 198, 198, 198, 214, 254, 238, 198, 130, 0, 0, 0, 0},
{0, 0, 198, 198, 108, 108, 56, 56, 108, 108, 198, 198, 0, 0, 0, 0},
{0, 0, 195, 195, 102, 102, 60, 24, 24, 24, 24, 24, 0, 0, 0, 0},
{0, 0, 254, 6, 6, 12, 24, 48, 96, 192, 192, 254, 0, 0, 0, 0},
{0, 0, 60, 32, 32, 32, 32, 32, 32, 32, 32, 60, 0, 0, 0, 0},
{0, 0, 96, 96, 48, 48, 24, 24, 12, 12, 6, 6, 0, 0, 0, 0},
{0, 0, 60, 12, 12, 12, 12, 12, 12, 12, 12, 60, 0, 0, 0, 0},
{0, 24, 60, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 254, 0, 0},
{96, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 124, 6, 126, 198, 198, 198, 126, 0, 0, 0, 0},
{0, 0, 192, 192, 192, 252, 198, 198, 198, 198, 198, 252, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 124, 198, 192, 192, 192, 198, 124, 0, 0, 0, 0},
{0, 0, 6, 6, 6, 126, 198, 198, 198, 198, 198, 126, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 124, 198, 198, 254, 192, 192, 124, 0, 0, 0, 0},
{0, 0, 30, 48, 48, 252, 48, 48, 48, 48, 48, 48, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 126, 198, 198, 198, 198, 198, 126, 6, 6, 124, 0}, //g
{0, 0, 192, 192, 192, 252, 198, 198, 198, 198, 198, 198, 0, 0, 0, 0},
{0, 0, 24, 24, 0, 56, 24, 24, 24, 24, 24, 60, 0, 0, 0, 0},
{0, 0, 6, 6, 0, 14, 6, 6, 6, 6, 6, 102, 102, 60, 0, 0},
{0, 0, 192, 192, 192, 198, 204, 216, 240, 216, 204, 198, 0, 0, 0, 0},
{0, 0, 56, 24, 24, 24, 24, 24, 24, 24, 24, 60, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 252, 214, 214, 214, 214, 214, 214, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 252, 198, 198, 198, 198, 198, 198, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 124, 198, 198, 198, 198, 198, 124, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 252, 198, 198, 198, 198, 198, 252, 192, 192, 192, 0},
{0, 0, 0, 0, 0, 126, 198, 198, 198, 198, 198, 126, 6, 6, 6, 0},
{0, 0, 0, 0, 0, 222, 240, 224, 192, 192, 192, 192, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 126, 192, 192, 124, 6, 6, 252, 0, 0, 0, 0}, //s
{0, 0, 48, 48, 48, 252, 48, 48, 48, 48, 48, 30, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 198, 198, 198, 198, 198, 198, 126, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 198, 198, 198, 108, 108, 56, 56, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 198, 198, 214, 214, 214, 214, 124, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 198, 198, 108, 56, 108, 198, 198, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 198, 198, 198, 198, 198, 198, 126, 6, 6, 124, 0},
{0, 0, 0, 0, 0, 254, 12, 24, 48, 96, 192, 254, 0, 0, 0, 0},
{0, 0, 28, 48, 48, 48, 96, 48, 48, 48, 48, 28, 0, 0, 0, 0},
{0, 0, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 0, 0, 0, 0},
{0, 0, 112, 24, 24, 24, 12, 24, 24, 24, 24, 112, 0, 0, 0, 0},
{0, 115, 219, 206, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 124, 198, 198, 198, 198, 254, 198, 198, 198, 198, 6, 12, 7, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 96, 96, 96, 96, 112, 224, 96, 96, 96, 127, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{24, 48, 0, 124, 198, 192, 192, 124, 6, 6, 198, 124, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{24, 48, 0, 254, 6, 12, 24, 48, 96, 192, 192, 254, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{8, 28, 26, 26, 26, 26, 26, 24, 24, 90, 189, 189, 189, 189, 189, 189},
{24, 24, 0, 254, 6, 12, 24, 48, 96, 192, 192, 254, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 124, 6, 126, 198, 198, 198, 126, 6, 12, 7, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 56, 24, 24, 24, 28, 56, 24, 24, 24, 60, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 12, 24, 0, 126, 192, 192, 124, 6, 6, 252, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{16, 0, 56, 36, 36, 60, 36, 38, 231, 181, 181, 181, 145, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 24, 48, 0, 254, 12, 24, 48, 96, 192, 254, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 24, 24, 0, 254, 12, 24, 48, 96, 192, 254, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{24, 48, 0, 124, 198, 198, 192, 192, 192, 198, 198, 124, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 254, 192, 192, 192, 248, 192, 192, 192, 192, 254, 6, 12, 7, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{24, 48, 198, 198, 198, 230, 246, 222, 206, 198, 198, 198, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{24, 48, 0, 124, 198, 198, 198, 198, 198, 198, 198, 124, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 24, 48, 0, 124, 198, 192, 192, 192, 198, 124, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 124, 198, 198, 254, 192, 192, 124, 24, 48, 28, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 24, 48, 0, 252, 198, 198, 198, 198, 198, 198, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 24, 48, 0, 124, 198, 198, 198, 198, 198, 124, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};


static inline uint8_t color(enum vga_color bg, enum vga_color fg)
{
    return COLOR(bg, fg);
}

inline void set_color(enum vga_color bg, enum vga_color fg)
{
    terminal_color = COLOR(bg, fg);
	terminal_color = 0xAAAAAA;
}

void put_pixel(int x, int y, uint32_t color)
{
    vesa_buffer[y * screen_width + x] = color; 
}

void put_character_at(uint8_t character, uint32_t color, uint8_t char_y, uint8_t char_x)
{
    for(int y = 0; y < 16; y++)
        for(int x = 0; x < 8; x++)
			if(font[character][y] & (1 << (7 - x)))
            	put_pixel(char_x * 8 + x, char_y * 16 + y, color);
			else
				put_pixel(char_x * 8 + x, char_y * 16 + y, 0);
}

void set_cursor(uint8_t y, uint8_t x)
{
    put_character_at('_', terminal_color, y, x);
}

void terminal_initialize(uint32_t buffer, uint32_t width, uint32_t height)
{   
    vesa_buffer = (uint32_t*)buffer;

	screen_width = width;
	screen_height = height;

	terminal_columns = screen_width / 8;
	terminal_rows = screen_height / 16;
    
    for(uint8_t y = 0; y < terminal_rows; y++)
        for(uint8_t x = 0; x < terminal_columns; x++)
            put_character_at(' ', terminal_color, y, x);
    
    terminal_row = terminal_column = 0;
    set_cursor(terminal_row, terminal_column);

    printf("%4x%4\n", screen_width, screen_height);
}

void update_cursor()
{
    set_cursor(terminal_row, terminal_column);
}